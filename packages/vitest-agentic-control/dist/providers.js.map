{"version":3,"sources":["../src/providers.ts"],"names":[],"mappings":"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","file":"providers.js","sourcesContent":["/**\n * AI Provider mocking utilities for agentic-control testing.\n *\n * This module provides utilities for mocking AI providers (Anthropic, OpenAI,\n * Google, Mistral, Azure, Ollama) during testing. It allows you to simulate\n * AI model responses without making actual API calls.\n *\n * @module providers\n */\n\nimport { type Mock, vi } from 'vitest';\n\n/**\n * List of supported AI providers.\n */\nexport const SUPPORTED_PROVIDERS = [\n  'anthropic',\n  'openai',\n  'google',\n  'mistral',\n  'azure',\n  'ollama',\n] as const;\n\nexport type SupportedProvider = (typeof SUPPORTED_PROVIDERS)[number];\n\n/**\n * Provider module paths for mocking.\n */\nexport const PROVIDER_MODULES: Record<SupportedProvider, string> = {\n  anthropic: '@ai-sdk/anthropic',\n  openai: '@ai-sdk/openai',\n  google: '@ai-sdk/google',\n  mistral: '@ai-sdk/mistral',\n  azure: '@ai-sdk/azure',\n  ollama: 'ai-sdk-ollama',\n};\n\n/**\n * Common AI SDK modules.\n */\nexport const AI_SDK_MODULES = ['ai', 'ai/rsc'] as const;\n\n/**\n * Mock provider response configuration.\n */\nexport interface MockProviderResponse {\n  /** The text response to return */\n  response?: string;\n  /** Tool calls to include in response */\n  toolCalls?: Array<{\n    name: string;\n    args: Record<string, unknown>;\n  }>;\n  /** Whether the response should stream */\n  stream?: boolean;\n  /** Simulated latency in ms */\n  latency?: number;\n  /** Error to throw instead of returning response */\n  error?: Error;\n  /** Usage information */\n  usage?: {\n    promptTokens: number;\n    completionTokens: number;\n    totalTokens: number;\n  };\n}\n\n/**\n * Mock stream chunk for streaming responses.\n */\nexport interface MockStreamChunk {\n  /** Text delta */\n  textDelta?: string;\n  /** Tool call start */\n  toolCallStart?: {\n    name: string;\n    id: string;\n  };\n  /** Tool call delta (args) */\n  toolCallDelta?: {\n    id: string;\n    args: string;\n  };\n  /** Whether this is the final chunk */\n  isFinished?: boolean;\n}\n\n/**\n * Options for creating a ProviderMocker instance.\n */\nexport interface ProviderMockerOptions {\n  /** Default response for all providers */\n  defaultResponse?: MockProviderResponse;\n  /** Whether to auto-mock all provider modules */\n  autoMock?: boolean;\n}\n\n/**\n * Mock model instance for a provider.\n */\ninterface MockModel {\n  /** Generate a response */\n  generate: Mock<(prompt: string, options?: unknown) => Promise<unknown>>;\n  /** Generate a streaming response */\n  generateStream: Mock<(prompt: string, options?: unknown) => AsyncGenerator<MockStreamChunk>>;\n  /** The provider this model belongs to */\n  provider: SupportedProvider;\n  /** Model ID */\n  modelId: string;\n}\n\n/**\n * AI Provider mocking utilities class.\n *\n * Provides methods for mocking AI provider responses during testing.\n *\n * @example\n * ```typescript\n * import { ProviderMocker } from 'vitest-agentic-control';\n *\n * const mocker = new ProviderMocker();\n *\n * // Mock Anthropic provider\n * mocker.mockAnthropic({\n *   response: 'Hello! I am Claude.',\n *   usage: { promptTokens: 10, completionTokens: 20, totalTokens: 30 },\n * });\n *\n * // Mock OpenAI provider with streaming\n * mocker.mockOpenAI({\n *   response: 'Hello! I am GPT.',\n *   stream: true,\n * });\n *\n * // Mock a specific model\n * const model = mocker.createMockModel('anthropic', 'claude-sonnet-4-20250514');\n * ```\n */\nexport class ProviderMocker {\n  /** Default response configuration */\n  private defaultResponse: MockProviderResponse;\n\n  /** Track mocked modules */\n  private readonly mockedModules: Set<string> = new Set();\n\n  /** Track provider-specific configurations */\n  private readonly providerConfigs: Map<SupportedProvider, MockProviderResponse> = new Map();\n\n  /** Track mock models */\n  public readonly models: Map<string, MockModel> = new Map();\n\n  constructor(options: ProviderMockerOptions = {}) {\n    this.defaultResponse = options.defaultResponse ?? {\n      response: 'This is a mock AI response.',\n    };\n\n    if (options.autoMock) {\n      this.mockAllModules();\n    }\n  }\n\n  /**\n   * Mock the Anthropic provider.\n   *\n   * @param config - Response configuration\n   */\n  mockAnthropic(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('anthropic', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('anthropic');\n  }\n\n  /**\n   * Mock the OpenAI provider.\n   *\n   * @param config - Response configuration\n   */\n  mockOpenAI(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('openai', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('openai');\n  }\n\n  /**\n   * Mock the Google provider.\n   *\n   * @param config - Response configuration\n   */\n  mockGoogle(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('google', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('google');\n  }\n\n  /**\n   * Mock the Mistral provider.\n   *\n   * @param config - Response configuration\n   */\n  mockMistral(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('mistral', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('mistral');\n  }\n\n  /**\n   * Mock the Azure provider.\n   *\n   * @param config - Response configuration\n   */\n  mockAzure(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('azure', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('azure');\n  }\n\n  /**\n   * Mock the Ollama provider.\n   *\n   * @param config - Response configuration\n   */\n  mockOllama(config: MockProviderResponse = {}): void {\n    this.providerConfigs.set('ollama', { ...this.defaultResponse, ...config });\n    this.mockProviderModule('ollama');\n  }\n\n  /**\n   * Mock a specific provider module.\n   *\n   * @param provider - The provider to mock\n   */\n  private mockProviderModule(provider: SupportedProvider): void {\n    const modulePath = PROVIDER_MODULES[provider];\n    const config = this.providerConfigs.get(provider) ?? this.defaultResponse;\n\n    const mockProvider = this.createMockProviderFactory(provider, config);\n\n    vi.doMock(modulePath, () => mockProvider);\n    this.mockedModules.add(modulePath);\n  }\n\n  /**\n   * Create a mock provider factory function.\n   *\n   * @param provider - The provider type\n   * @param config - Response configuration\n   * @returns Mock provider factory\n   */\n  private createMockProviderFactory(\n    provider: SupportedProvider,\n    config: MockProviderResponse\n  ): Record<string, unknown> {\n    const createModel = (modelId: string) => {\n      const model = this.createMockModel(provider, modelId, config);\n      return model;\n    };\n\n    // Return appropriate factory based on provider\n    switch (provider) {\n      case 'anthropic':\n        return {\n          anthropic: vi.fn().mockReturnValue({\n            chat: createModel,\n            messages: createModel,\n          }),\n          createAnthropic: vi.fn().mockReturnValue({\n            chat: createModel,\n            messages: createModel,\n          }),\n        };\n\n      case 'openai':\n        return {\n          openai: vi.fn().mockReturnValue({\n            chat: createModel,\n            completion: createModel,\n          }),\n          createOpenAI: vi.fn().mockReturnValue({\n            chat: createModel,\n            completion: createModel,\n          }),\n        };\n\n      case 'google':\n        return {\n          google: vi.fn().mockReturnValue({\n            generativeAI: createModel,\n          }),\n          createGoogle: vi.fn().mockReturnValue({\n            generativeAI: createModel,\n          }),\n        };\n\n      case 'mistral':\n        return {\n          mistral: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n          createMistral: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n        };\n\n      case 'azure':\n        return {\n          azure: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n          createAzure: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n        };\n\n      case 'ollama':\n        return {\n          ollama: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n          createOllama: vi.fn().mockReturnValue({\n            chat: createModel,\n          }),\n        };\n    }\n  }\n\n  /**\n   * Create a mock model for a provider.\n   *\n   * @param provider - The provider type\n   * @param modelId - The model ID\n   * @param config - Response configuration\n   * @returns Mock model instance\n   */\n  createMockModel(\n    provider: SupportedProvider,\n    modelId: string,\n    config: MockProviderResponse = {}\n  ): MockModel {\n    const mergedConfig = { ...this.defaultResponse, ...config };\n\n    const generate = vi.fn(async () => {\n      if (mergedConfig.latency) {\n        await new Promise((resolve) => setTimeout(resolve, mergedConfig.latency));\n      }\n\n      if (mergedConfig.error) {\n        throw mergedConfig.error;\n      }\n\n      return {\n        text: mergedConfig.response ?? 'Mock response',\n        toolCalls: mergedConfig.toolCalls ?? [],\n        usage: mergedConfig.usage ?? {\n          promptTokens: 10,\n          completionTokens: 20,\n          totalTokens: 30,\n        },\n      };\n    });\n\n    const generateStream = vi.fn(async function* () {\n      if (mergedConfig.latency) {\n        await new Promise((resolve) => setTimeout(resolve, mergedConfig.latency));\n      }\n\n      if (mergedConfig.error) {\n        throw mergedConfig.error;\n      }\n\n      const text = mergedConfig.response ?? 'Mock response';\n      const chunks = text.split(' ');\n\n      for (const chunk of chunks) {\n        yield { textDelta: `${chunk} ` };\n      }\n\n      yield { isFinished: true };\n    });\n\n    const model: MockModel = {\n      generate: generate as Mock<(prompt: string, options?: unknown) => Promise<unknown>>,\n      generateStream: generateStream as Mock<\n        (prompt: string, options?: unknown) => AsyncGenerator<MockStreamChunk>\n      >,\n      provider,\n      modelId,\n    };\n\n    this.models.set(`${provider}:${modelId}`, model);\n    return model;\n  }\n\n  /**\n   * Mock the core AI SDK module.\n   */\n  mockAiSdk(): void {\n    vi.doMock('ai', () => ({\n      generateText: vi.fn(async (options: { model: MockModel; prompt: string }) => {\n        return options.model.generate(options.prompt, options);\n      }),\n      streamText: vi.fn(async function* (options: { model: MockModel; prompt: string }) {\n        yield* options.model.generateStream(options.prompt, options);\n      }),\n      generateObject: vi.fn(async () => ({ object: {} })),\n      streamObject: vi.fn(async function* () {\n        yield { object: {} };\n      }),\n    }));\n\n    this.mockedModules.add('ai');\n  }\n\n  /**\n   * Mock all provider modules.\n   *\n   * @returns Dictionary of mocked modules\n   */\n  mockAllModules(): Record<string, unknown> {\n    const mocks: Record<string, unknown> = {};\n\n    // Mock AI SDK\n    this.mockAiSdk();\n    mocks.ai = true;\n\n    // Mock all providers\n    for (const provider of SUPPORTED_PROVIDERS) {\n      this.mockProviderModule(provider);\n      mocks[PROVIDER_MODULES[provider]] = true;\n    }\n\n    return mocks;\n  }\n\n  /**\n   * Set a response for a specific provider.\n   *\n   * @param provider - The provider\n   * @param config - Response configuration\n   */\n  setProviderResponse(provider: SupportedProvider, config: MockProviderResponse): void {\n    this.providerConfigs.set(provider, { ...this.defaultResponse, ...config });\n  }\n\n  /**\n   * Get the configuration for a provider.\n   *\n   * @param provider - The provider\n   * @returns The configuration or undefined\n   */\n  getProviderConfig(provider: SupportedProvider): MockProviderResponse | undefined {\n    return this.providerConfigs.get(provider);\n  }\n\n  /**\n   * Restore all mocked modules.\n   */\n  restoreAll(): void {\n    this.mockedModules.clear();\n    this.providerConfigs.clear();\n    this.models.clear();\n  }\n\n  /**\n   * Reset all mocks.\n   */\n  resetAll(): void {\n    for (const model of this.models.values()) {\n      model.generate.mockClear();\n      model.generateStream.mockClear();\n    }\n  }\n}\n\n/**\n * Factory function to create a ProviderMocker instance.\n *\n * @param options - Configuration options\n * @returns A new ProviderMocker instance\n */\nexport function createProviderMocker(options: ProviderMockerOptions = {}): ProviderMocker {\n  return new ProviderMocker(options);\n}\n"]}