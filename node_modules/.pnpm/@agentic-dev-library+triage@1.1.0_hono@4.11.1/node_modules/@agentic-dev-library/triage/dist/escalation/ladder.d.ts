/**
 * Escalation Ladder
 *
 * Implements a 7-level escalation strategy that exhausts all free options
 * before resorting to expensive cloud agents.
 *
 * Levels:
 * - 0: Static Analysis (lint/tsc) - Free, instant
 * - 1: Complexity Evaluation (Ollama) - Free, routes to 2 or 3
 * - 2: Ollama Fix - Free, simple fixes
 * - 3: Jules Session - Free tier, complex work
 * - 4: Jules + Boosted Context - Free tier, more context
 * - 5: Human Review Queue - Free, awaits approval
 * - 6: Cloud Agent (Cursor) - Expensive, requires approval
 */
import type { EscalationConfig } from './config.js';
import { CostTracker } from './cost-tracker.js';
import { type EscalationLevel, type EscalationState } from './state.js';
/**
 * Task to be processed by the escalation ladder
 */
export interface Task {
    /** Unique task identifier */
    id: string;
    /** Task description */
    description: string;
    /** Code/context for the task */
    context: string;
    /** Task metadata (e.g., labels, approvals) */
    metadata?: Record<string, unknown>;
}
/**
 * Result from processing a task
 */
export interface ProcessResult {
    /** Whether the task was resolved */
    success: boolean;
    /** Final escalation level reached */
    level: EscalationLevel;
    /** Result data (agent-specific) */
    data?: unknown;
    /** Error message if failed */
    error?: string;
    /** Total cost incurred (in cents) */
    cost: number;
    /** Number of attempts made */
    attempts: number;
    /** Trail of levels attempted */
    trail: Array<{
        level: EscalationLevel;
        success: boolean;
        error?: string;
    }>;
}
/**
 * Handler function for a specific escalation level
 */
export type LevelHandler = (task: Task, state: EscalationState) => Promise<{
    success: boolean;
    data?: unknown;
    error?: string;
    escalate: boolean;
    cost?: number;
}>;
/**
 * Escalation Ladder - intelligently routes tasks through 7 levels
 */
export declare class EscalationLadder {
    private config;
    private stateManager;
    private costTracker;
    private handlers;
    constructor(config?: Partial<EscalationConfig>);
    /**
     * Register a handler for a specific level
     */
    registerHandler(level: EscalationLevel, handler: LevelHandler): this;
    /**
     * Process a task through the escalation ladder
     */
    process(task: Task): Promise<ProcessResult>;
    /**
     * Get state for a task
     */
    getState(taskId: string): EscalationState;
    /**
     * Reset state for a task
     */
    resetState(taskId: string): void;
    /**
     * Get all states
     */
    getAllStates(): EscalationState[];
    /**
     * Get cost tracker
     */
    getCostTracker(): CostTracker;
    /**
     * Get configuration
     */
    getConfig(): EscalationConfig;
    /**
     * Update configuration
     */
    updateConfig(update: Partial<EscalationConfig>): void;
    /**
     * Check if level should be skipped
     */
    private shouldSkipLevel;
    /**
     * Check if level has exceeded max attempts
     */
    private hasExceededAttempts;
    /**
     * Check if task has cloud agent approval
     */
    private hasCloudAgentApproval;
}
//# sourceMappingURL=ladder.d.ts.map