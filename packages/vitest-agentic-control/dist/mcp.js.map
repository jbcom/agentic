{"version":3,"sources":["../src/mcp.ts"],"names":[],"mappings":"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","file":"mcp.js","sourcesContent":["/**\n * MCP (Model Context Protocol) mocking utilities for agentic-control testing.\n *\n * This module provides utilities for mocking MCP servers, tools, and resources\n * during testing. It allows you to simulate MCP server behavior without\n * needing actual MCP server implementations.\n *\n * @module mcp\n */\n\nimport { type Mock, vi } from 'vitest';\n\n/**\n * List of MCP-related modules that can be mocked.\n */\nexport const MCP_MODULES = [\n  '@modelcontextprotocol/sdk',\n  '@modelcontextprotocol/sdk/client',\n  '@modelcontextprotocol/sdk/server',\n  '@ai-sdk/mcp',\n] as const;\n\n/**\n * Definition for a mock MCP tool.\n */\nexport interface MockToolDefinition {\n  /** Tool name */\n  name: string;\n  /** Tool description */\n  description?: string;\n  /** Input schema (JSON Schema) */\n  inputSchema?: Record<string, unknown>;\n  /** Handler function for the tool */\n  handler: (args: unknown) => unknown | Promise<unknown>;\n}\n\n/**\n * Definition for a mock MCP resource.\n */\nexport interface MockResourceDefinition {\n  /** Resource URI */\n  uri: string;\n  /** Resource name */\n  name?: string;\n  /** Resource description */\n  description?: string;\n  /** MIME type */\n  mimeType?: string;\n  /** Resource content */\n  content: string | Buffer;\n}\n\n/**\n * Options for creating an McpMocker instance.\n */\nexport interface McpMockerOptions {\n  /** Whether to auto-mock all MCP modules */\n  autoMock?: boolean;\n}\n\n/**\n * Mock MCP tool with call tracking.\n */\nexport interface MockMcpTool {\n  /** Tool definition */\n  definition: MockToolDefinition;\n  /** Mock handler with call tracking */\n  handler: Mock<(args: unknown) => unknown | Promise<unknown>>;\n  /** Call history */\n  calls: unknown[];\n}\n\n/**\n * Mock MCP resource.\n */\nexport interface MockMcpResource {\n  /** Resource definition */\n  definition: MockResourceDefinition;\n  /** Read count */\n  readCount: number;\n}\n\n/**\n * Mock MCP server configuration.\n */\nexport interface MockMcpServerConfig {\n  /** Server name */\n  name: string;\n  /** Server tools */\n  tools?: MockToolDefinition[];\n  /** Server resources */\n  resources?: MockResourceDefinition[];\n  /** Server capabilities */\n  capabilities?: {\n    tools?: boolean;\n    resources?: boolean;\n    prompts?: boolean;\n  };\n}\n\n/**\n * Mock MCP server instance.\n */\nexport class MockMcpServer {\n  public readonly name: string;\n  public readonly tools: Map<string, MockMcpTool> = new Map();\n  public readonly resources: Map<string, MockMcpResource> = new Map();\n  public readonly capabilities: {\n    tools: boolean;\n    resources: boolean;\n    prompts: boolean;\n  };\n\n  private connected = false;\n\n  constructor(config: MockMcpServerConfig) {\n    this.name = config.name;\n    this.capabilities = {\n      tools: config.capabilities?.tools ?? true,\n      resources: config.capabilities?.resources ?? true,\n      prompts: config.capabilities?.prompts ?? false,\n    };\n\n    // Register tools\n    for (const tool of config.tools ?? []) {\n      this.registerTool(tool);\n    }\n\n    // Register resources\n    for (const resource of config.resources ?? []) {\n      this.registerResource(resource);\n    }\n  }\n\n  /**\n   * Register a tool with this mock server.\n   */\n  registerTool(definition: MockToolDefinition): MockMcpTool {\n    const mockTool: MockMcpTool = {\n      definition,\n      handler: vi.fn(definition.handler),\n      calls: [],\n    };\n    this.tools.set(definition.name, mockTool);\n    return mockTool;\n  }\n\n  /**\n   * Register a resource with this mock server.\n   */\n  registerResource(definition: MockResourceDefinition): MockMcpResource {\n    const mockResource: MockMcpResource = {\n      definition,\n      readCount: 0,\n    };\n    this.resources.set(definition.uri, mockResource);\n    return mockResource;\n  }\n\n  /**\n   * Connect to this mock server.\n   */\n  async connect(): Promise<void> {\n    this.connected = true;\n  }\n\n  /**\n   * Disconnect from this mock server.\n   */\n  async disconnect(): Promise<void> {\n    this.connected = false;\n  }\n\n  /**\n   * Check if connected.\n   */\n  isConnected(): boolean {\n    return this.connected;\n  }\n\n  /**\n   * List available tools.\n   */\n  async listTools(): Promise<\n    Array<{\n      name: string;\n      description?: string;\n      inputSchema?: Record<string, unknown>;\n    }>\n  > {\n    return Array.from(this.tools.values()).map((tool) => ({\n      name: tool.definition.name,\n      description: tool.definition.description,\n      inputSchema: tool.definition.inputSchema,\n    }));\n  }\n\n  /**\n   * Call a tool.\n   */\n  async callTool(name: string, args: unknown): Promise<unknown> {\n    const tool = this.tools.get(name);\n    if (!tool) {\n      throw new Error(`Tool not found: ${name}`);\n    }\n    tool.calls.push(args);\n    return tool.handler(args);\n  }\n\n  /**\n   * List available resources.\n   */\n  async listResources(): Promise<\n    Array<{\n      uri: string;\n      name?: string;\n      description?: string;\n      mimeType?: string;\n    }>\n  > {\n    return Array.from(this.resources.values()).map((resource) => ({\n      uri: resource.definition.uri,\n      name: resource.definition.name,\n      description: resource.definition.description,\n      mimeType: resource.definition.mimeType,\n    }));\n  }\n\n  /**\n   * Read a resource.\n   */\n  async readResource(uri: string): Promise<{\n    uri: string;\n    mimeType?: string;\n    content: string | Buffer;\n  }> {\n    const resource = this.resources.get(uri);\n    if (!resource) {\n      throw new Error(`Resource not found: ${uri}`);\n    }\n    resource.readCount++;\n    return {\n      uri: resource.definition.uri,\n      mimeType: resource.definition.mimeType,\n      content: resource.definition.content,\n    };\n  }\n\n  /**\n   * Reset all call history.\n   */\n  reset(): void {\n    for (const tool of this.tools.values()) {\n      tool.handler.mockClear();\n      tool.calls = [];\n    }\n    for (const resource of this.resources.values()) {\n      resource.readCount = 0;\n    }\n  }\n}\n\n/**\n * MCP mocking utilities class.\n *\n * Provides methods for mocking MCP servers, tools, and resources\n * during testing.\n *\n * @example\n * ```typescript\n * import { McpMocker } from 'vitest-agentic-control';\n *\n * const mocker = new McpMocker();\n *\n * // Create a mock MCP server\n * const server = mocker.mockServer('test-server', {\n *   tools: [\n *     {\n *       name: 'get_weather',\n *       description: 'Get weather for a location',\n *       handler: (args) => ({ temp: 72, condition: 'sunny' }),\n *     },\n *   ],\n *   resources: [\n *     {\n *       uri: 'file:///config.json',\n *       content: '{\"key\": \"value\"}',\n *     },\n *   ],\n * });\n *\n * // Use the mock server in tests\n * await server.connect();\n * const result = await server.callTool('get_weather', { location: 'NYC' });\n * ```\n */\nexport class McpMocker {\n  /** Map of mock servers by name */\n  public readonly servers: Map<string, MockMcpServer> = new Map();\n\n  /** Track mocked modules */\n  private readonly mockedModules: Set<string> = new Set();\n\n  constructor(options: McpMockerOptions = {}) {\n    if (options.autoMock) {\n      this.mockAllModules();\n    }\n  }\n\n  /**\n   * Create a mock MCP server.\n   *\n   * @param name - Server name\n   * @param config - Server configuration\n   * @returns The mock server\n   */\n  mockServer(name: string, config: Omit<MockMcpServerConfig, 'name'> = {}): MockMcpServer {\n    const server = new MockMcpServer({ name, ...config });\n    this.servers.set(name, server);\n    return server;\n  }\n\n  /**\n   * Get a mock server by name.\n   *\n   * @param name - Server name\n   * @returns The mock server or undefined\n   */\n  getServer(name: string): MockMcpServer | undefined {\n    return this.servers.get(name);\n  }\n\n  /**\n   * Mock the MCP client module.\n   *\n   * @returns Mock client factory\n   */\n  mockClient(): Mock {\n    const mockClientFactory = vi.fn((serverName: string) => {\n      const server = this.servers.get(serverName);\n      if (!server) {\n        throw new Error(`No mock server registered: ${serverName}`);\n      }\n      return server;\n    });\n\n    vi.doMock('@modelcontextprotocol/sdk/client', () => ({\n      Client: mockClientFactory,\n    }));\n\n    this.mockedModules.add('@modelcontextprotocol/sdk/client');\n    return mockClientFactory;\n  }\n\n  /**\n   * Mock all MCP-related modules.\n   *\n   * @returns Dictionary of mocked modules\n   */\n  mockAllModules(): Record<string, unknown> {\n    const mocks: Record<string, unknown> = {};\n\n    // Mock SDK client\n    mocks['@modelcontextprotocol/sdk/client'] = {\n      Client: vi.fn().mockImplementation((serverName: string) => {\n        return this.servers.get(serverName) ?? new MockMcpServer({ name: serverName });\n      }),\n    };\n\n    // Mock SDK server\n    mocks['@modelcontextprotocol/sdk/server'] = {\n      Server: vi.fn().mockImplementation((config: MockMcpServerConfig) => {\n        return new MockMcpServer(config);\n      }),\n    };\n\n    // Mock AI SDK MCP integration\n    mocks['@ai-sdk/mcp'] = {\n      experimental_createMCPClient: vi.fn().mockImplementation(async (config: { name: string }) => {\n        return this.servers.get(config.name) ?? new MockMcpServer({ name: config.name });\n      }),\n    };\n\n    for (const [modulePath, mock] of Object.entries(mocks)) {\n      vi.doMock(modulePath, () => mock as Record<string, unknown>);\n      this.mockedModules.add(modulePath);\n    }\n\n    return mocks;\n  }\n\n  /**\n   * Create a mock tool that can be registered with servers.\n   *\n   * @param name - Tool name\n   * @param handler - Tool handler\n   * @param options - Additional options\n   * @returns Tool definition\n   */\n  createMockTool(\n    name: string,\n    handler: (args: unknown) => unknown | Promise<unknown>,\n    options: {\n      description?: string;\n      inputSchema?: Record<string, unknown>;\n    } = {}\n  ): MockToolDefinition {\n    return {\n      name,\n      description: options.description,\n      inputSchema: options.inputSchema,\n      handler,\n    };\n  }\n\n  /**\n   * Create a mock resource that can be registered with servers.\n   *\n   * @param uri - Resource URI\n   * @param content - Resource content\n   * @param options - Additional options\n   * @returns Resource definition\n   */\n  createMockResource(\n    uri: string,\n    content: string | Buffer,\n    options: {\n      name?: string;\n      description?: string;\n      mimeType?: string;\n    } = {}\n  ): MockResourceDefinition {\n    return {\n      uri,\n      content,\n      name: options.name,\n      description: options.description,\n      mimeType: options.mimeType,\n    };\n  }\n\n  /**\n   * Restore all mocked modules.\n   */\n  restoreAll(): void {\n    this.mockedModules.clear();\n    this.servers.clear();\n  }\n\n  /**\n   * Reset all mock servers.\n   */\n  resetAll(): void {\n    for (const server of this.servers.values()) {\n      server.reset();\n    }\n  }\n}\n\n/**\n * Factory function to create an McpMocker instance.\n *\n * @param options - Configuration options\n * @returns A new McpMocker instance\n */\nexport function createMcpMocker(options: McpMockerOptions = {}): McpMocker {\n  return new McpMocker(options);\n}\n"]}