/**
 * GitHub Issue Storage
 *
 * Stores queue state in a GitHub Issue body with:
 * - JSON state in code block between markers
 * - Human-readable status table
 * - Distributed locking via issue comments
 */
import type { QueueItem, QueueLock, QueueState } from '../queue/types.js';
import type { QueueStorage } from './interface.js';
export interface GitHubIssueStorageOptions {
    /** Repository in format "owner/repo" */
    repo: string;
    /** Issue number, or 'auto' to create if doesn't exist */
    issueNumber: number | 'auto';
    /** Issue title when auto-creating */
    issueTitle?: string;
    /** GitHub token for authentication */
    token: string;
    /** Optional Octokit instance (for testing) */
    octokit?: GitHubIssueStorageOctokit;
}
/**
 * Minimal Octokit interface for GitHub operations
 * Allows dependency injection for testing
 */
export interface GitHubIssueStorageOctokit {
    rest: {
        issues: {
            get(params: {
                owner: string;
                repo: string;
                issue_number: number;
            }): Promise<{
                data: {
                    body: string | null;
                    number: number;
                };
            }>;
            create(params: {
                owner: string;
                repo: string;
                title: string;
                body: string;
                labels?: string[];
            }): Promise<{
                data: {
                    number: number;
                };
            }>;
            update(params: {
                owner: string;
                repo: string;
                issue_number: number;
                body: string;
            }): Promise<unknown>;
            listComments(params: {
                owner: string;
                repo: string;
                issue_number: number;
                per_page?: number;
            }): Promise<{
                data: Array<{
                    id: number;
                    body?: string;
                    created_at: string;
                }>;
            }>;
            createComment(params: {
                owner: string;
                repo: string;
                issue_number: number;
                body: string;
            }): Promise<{
                data: {
                    id: number;
                };
            }>;
            deleteComment(params: {
                owner: string;
                repo: string;
                comment_id: number;
            }): Promise<unknown>;
        };
    };
}
/**
 * GitHub Issue storage implementation
 */
export declare class GitHubIssueStorage<T extends QueueItem = QueueItem> implements QueueStorage<T> {
    private owner;
    private repoName;
    private issueNumber;
    private issueTitle;
    private token;
    private octokit;
    private actualIssueNumber;
    private octokitPromise;
    constructor(options: GitHubIssueStorageOptions);
    read(): Promise<QueueState<T>>;
    write(state: QueueState<T>): Promise<void>;
    acquireLock(holder: string, ttlMs: number): Promise<boolean>;
    releaseLock(holder: string): Promise<void>;
    isLocked(): Promise<boolean>;
    getLock(): Promise<QueueLock | null>;
    private getOctokit;
    private getOrCreateIssue;
    private createIssue;
    private parseIssueBody;
    private formatIssueBody;
    private formatTableRow;
    private getPriorityEmoji;
    private getStatusEmoji;
    private parseLockComment;
    private createEmptyState;
}
//# sourceMappingURL=github-issue.d.ts.map